FROM continuumio/miniconda3

# Set the working directory to /app
WORKDIR /app

# Copy the current directory contents into the container at /app

RUN conda info --envs
RUN conda env create --name AICam
SHELL ["/bin/bash", "-c"]
RUN echo "conda activate AICam" > ~/.bashrc
ENV PATH /opt/conda/envs/AICam/bin:$PATH

#RUN conda update --all --name base
#
#RUN conda install --name AICam -c conda-forge compilers make
RUN conda install --name AICam -c conda-forge opencv matplotlib flask
RUN pip install tensorflow==2.12.0
RUN conda install --name AICam pandas
RUN conda install -n AICam -c conda-forge uwsgi
RUN pip install aiortc

# Install uWSGI inside the Conda environment
#RUN /bin/bash -c "source activate AICam"
COPY . .

EXPOSE 5000

# Set the PATH to include Conda environment
#ENV PATH /opt/conda/envs/AICam/bin:$PATH
# Run the command to start uWSGI
#CMD ["uwsgi", "app.ini"]
